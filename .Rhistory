outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd$y<-round(runif(16, min=1, max=84))
lsd
lsd$reps<-rep(12*7, 16)
lsd
mod<-glm(cbind(y, reps-y)~row+col+display, data=lsd, family="binomial")
anova(mod, test="Chisq")
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/BankData.csv")
df %>% summarize("amount mean"=mean(amount), "amount sd"=sd(amount))
df %>% count(loan) %>% mutate(prop=prop.table(n))
df %>% count(housing) %>% mutate(prop=prop.table(n))
size<-c(10, 30, 100, 250, 500, 1000, 2000, 4000, 8000)
control.amount<-c()
control.loan<-c()
control.housing<-c()
treat.amount<-c()
treat.loan<-c()
treat.housing<-c()
for (i in 1:length(size)){
control.index<-sample(1:nrow(df), size=size[i])
s<-df[control.index, ]
control.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
control.loan[i]=0
} else {
control.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
control.housing[i]=0
} else {
control.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
treat.index<-sample(1:nrow(df[-control.index,]), size=size[i])
dfc<-df[-control.index,]
s<-dfc[treat.index, ]
treat.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
treat.loan[i]=0
} else {
treat.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
treat.housing[i]=0
} else {
treat.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
}
control<-data.frame(size, amount=control.amount, loan=control.loan, housing=control.housing)
control
treatment<-data.frame(size, amount=treat.amount, loan=treat.loan, housing=treat.housing)
treatment
res<-rbind(control, treatment)
res$type<-c(rep("control",nrow(control)), rep("treamtment", nrow(treatment)))
ggplot(res, aes(x=size, y=amount, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=mean(df$amount),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("average amount in account")+
theme(legend.title=element_blank())
ggplot(res, aes(x=size, y=loan, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=(table(df$loan)[2]/sum(table(df$loan))),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("proportion of personal loan=yes")+
theme(legend.title=element_blank())
ggplot(res, aes(x=size, y=housing, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=(table(df$housing)[2]/sum(table(df$housing))),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("proportion of personal loan=yes")+
theme(legend.title=element_blank())
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/typing.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("before", "after"),
names_to = "test",
values_to="score")
boxplot(score~test,data=df_long)
df_long %>% group_by(test) %>% summarize("mean"=mean(score), "sd"=sd(score), "count"=n())
t.test(score~test, data=df_long)
df_long$test<-factor(df_long$test, levels=c("before", "after"))
df_long %>% ggplot(aes(x=test, y=score, group=employee))+
geom_line(alpha=0.8)+
geom_point(alpha=0.7, size=2.5)+
theme_bw(base_size = 12)+
xlab("")+
ylab("Test score")
t.test(score~test, data=df_long, paired=TRUE)
power.t.test(delta=5, sd=11, power=0.8, sig.level = 0.05, type="paired")
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
mower<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowersex.csv", stringsAsFactors = TRUE)
mower$Y.ownership<-as.factor(mower$Y.ownership)
prop.table(table(mower$Ownership))
levels(mower$Ownership)
log.reg<-glm(Ownership~., data=mower[,-4], family="binomial")
summary(log.reg)
exp( 0.9638 )
summary(log.reg)
1-pchisq(33.271-15.323, 23-21)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( mower$Y.ownership, predictions)
mower1<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowers2.csv", stringsAsFactors = TRUE)
mower1$Baldness<-as.factor(mower1$Baldness)
log.reg1<-glm(Ownership~., data=mower1, family="binomial")
summary(log.reg1)
exp( 3.12185)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
View(df)
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
log.reg<-glm(Personal.Loan~.-ID, data=df, family="binomial")
summary(log.reg)
is.na(colSums(df))
colSums(is.na(df))
1-pchisq(3162-1284.3, 4999-4987)
1-pchisq(33.271-15.323, 23-21)
1-pchisq(3162-1284.3, 4999-4987)
log.reg<-glm(Personal.Loan~.-ID-ZIP.Code, data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1284.4, 4999-4988)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
colSums(is.na(df))
log.reg<-glm(Personal.Loan~.-ID-ZIP.Code, data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc(df$Personal.Loan, predictions)
install.packages("pROC")
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc(df$Personal.Loan, predictions)
library(pROC)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc(df$Personal.Loan, predictions)
roc_object$auc
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( mower$Y.ownership, predictions)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
pacman::p_load(tidyverse, DataExplorer,  ggplot2, pROC)
mower<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowersex.csv", stringsAsFactors = TRUE)
mower$Y.ownership<-as.factor(mower$Y.ownership)
prop.table(table(mower$Ownership))
levels(mower$Ownership)
log.reg<-glm(Ownership~., data=mower[,-4], family="binomial")
summary(log.reg)
exp( 0.9638 )
summary(log.reg)
1-pchisq(33.271-15.323, 23-21)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( mower$Y.ownership, predictions)
roc_object$auc
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
log.reg<-glm(Personal.Loan~.-ID-ZIP.Code, data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc(df$Personal.Loan, predictions)
roc_object$auc
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
mower1<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowers2.csv", stringsAsFactors = TRUE)
mower1$Baldness<-as.factor(mower1$Baldness)
log.reg1<-glm(Ownership~., data=mower1, family="binomial")
summary(log.reg1)
log.reg1<-glm(Personal.Loan~., data=mower1, family="binomial")
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
log.reg<-glm(Personal.Loan~.-ID-ZIP.Code, data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
log.reg1<-glm(Personal.Loan~., data=mower1, family="binomial")
log.reg1<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg1)
exp(.06026)
exp( 3.12185)
exp(-.07564)
step_model <- step(log.reg1)
summary(step_model)
best_model = glm(formula = Personal.Loan ~ Income + Family + CCAvg + Education +
Securities.Account + CD.Account + Online + CreditCard, family = "binomial",
data = df)
best_model = glm(formula = Personal.Loan ~ Income + Family + CCAvg + Education +
Securities.Account + CD.Account + Online + CreditCard, family = "binomial",
data = df)
summary(best_model)
exp(0.618492*4)+exp(0.151415*400)+exp(3.938590)-exp(0.752211)
exp(0.050528*29000)+exp(0.618492*4)+exp(0.151415*400)+exp(3.938590)-exp(0.752211)
-12.970712 + exp(0.050528*29000)+exp(0.618492*4)+exp(0.151415*400)+exp(3.938590)-exp(0.752211)
-12.970712 + (0.060528*29000)+(0.618492*4)+(0.151415*400)+3.938590-0.752211
exp(1808.568)
exp(-12.970712)
exp(1808.568)/exp(-12.970712)
df <- df %>% select(c(-ID, -ZIP.Code))
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
df <- df %>% select(c(-ID, -ZIP.Code))
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
exp(.06026)
exp(6.026e-02)
exp(.06026)
exp(-.07564)
exp(-7.564e-01)
exp(-7.564e-01)
head(predictions)
log.odds<-predictions[6]
odds<-exp(log.odds)
odds
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
df <- df %>% select(c(-ID, -ZIP.Code))
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
log.reg1<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg1)
exp(.06026)
exp(-7.564e-01)
step_model <- step(log.reg1)
summary(step_model)
best_model = glm(formula = Personal.Loan ~ Income + Family + CCAvg + Education +
Securities.Account + CD.Account + Online + CreditCard, family = "binomial",
data = df)
summary(best_model)
head(predictions)
log.odds<-predictions[6]
odds<-exp(log.odds)
odds
View(df)
-12.970712 + (0.060528*29)+(0.618492*4)+(0.151415*400)+3.938590-0.752211
exp(55.01095)
View(df)
-12.970712 + (0.060528*29)+(0.618492*4)+(0.151415*0.4)+3.938590-0.752211
exp(-5.494487)
head(predictions)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
df <- df %>% select(c(-ID, -ZIP.Code))
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
log.reg1<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg1)
exp(.06026)
exp(-7.564e-01)
step_model <- step(log.reg1)
summary(step_model)
best_model = glm(formula = Personal.Loan ~ Income + Family + CCAvg + Education +
Securities.Account + CD.Account + Online + CreditCard, family = "binomial",
data = df)
summary(best_model)
head(predictions)
log.odds<-predictions[6]
odds<-exp(log.odds)
odds
-12.970712 + (0.060528*29)+(0.618492*4)+(0.151415*0.4)+3.938590-0.752211
exp(-5.494487)
exp(-12.970712)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/UniversalBank.csv", stringsAsFactors = TRUE)
df$Education = as.factor(df$Education)
df$Securities.Account = as.factor(df$Securities.Account)
df$CD.Account = as.factor(df$CD.Account)
df$Online = as.factor(df$Online)
df$CreditCard = as.factor(df$CreditCard)
df$Personal.Loan = as.factor(df$Personal.Loan)
colSums(is.na(df))
df <- df %>% select(c(-ID, -ZIP.Code))
log.reg<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg)
1-pchisq(3162-1172.3, 4999-4987)
predictions<-predict(log.reg, type="response") #to get probabilities and not log(odds)
roc_object<-roc( df$Personal.Loan, predictions)
roc_object$auc
log.reg1<-glm(Personal.Loan~., data=df, family="binomial")
summary(log.reg1)
exp(.06026)
exp(-7.564e-01)
step_model <- step(log.reg1)
summary(step_model)
best_model = glm(formula = Personal.Loan ~ Income + Family + CCAvg + Education +
Securities.Account + CD.Account + Online + CreditCard, family = "binomial",
data = df)
summary(best_model)
head(predictions)
log.odds<-predictions[6]
odds<-exp(log.odds)
odds
log.odds<-predictions[6]
odds<-exp(log.odds)
odds
-12.970712 + (0.060528*29)+(0.618492*4)+(0.151415*0.4)+3.938590-0.752211
exp(-5.494487)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
# simulate the data
dat<- tibble(
x=rnorm(n=1000,mean=50, sd=25)
) %>% mutate(
x=if_else(x<0, 0, x) ## replaces negative values with 0
) %>% filter (x<100)
# cutoff at x=50
dat<- dat %>%
mutate (
D=if_else(x>50,1,0), ## This creates a dummy variable for the cut off value
y1=20+0*D+1.5*x+rnorm(n(), 0,20) ## simulate the truth
)
ggplot(data=dat, aes(x, y1, color=factor(D)))+
geom_point(alpha=0.5)+
geom_vline(xintercept=50, color="gray", linetype=2)+
stat_smooth(method="lm", se=F)+
labs(x="Test score (X)", y="Potential Outcome (Y1)")+theme_bw()
dat<- dat %>%
mutate (
D=if_else(x>50,1,0),
y1=20+40*D+1.5*x+rnorm(n(), 0,20)
) ## there is an effect with test score is greater than 50
ggplot(data=dat, aes(x, y1, color=factor(D)))+
geom_point(alpha=0.5)+
geom_vline(xintercept=50, color="gray", linetype=2)+
stat_smooth(method="lm", se=F)+
labs(x="Test score (X)", y="Potential Outcome (Y1)")+theme_bw()
reg<-lm(y1~x+factor(D), data=dat)
summary(reg)
library(foreign)
mydata = read.dta("http://dss.princeton.edu/training/Panel101.dta")
mydata$time = ifelse(mydata$year >= 1994, 1, 0)
mydata$treated = ifelse(mydata$country == "E" |
mydata$country == "F" | mydata$country == "G" ,
1,
0)
mydata$did = mydata$time * mydata$treated
set.seed(1)
year         <- rep(1:30, 10)
state        <- rep(LETTERS[1:10], each = 30)
X1           <- round(rnorm(300, mean = 2, sd = 1), 2)
X2           <- round(rbinom(300, 1, 0.5) + rnorm(300), 2)
Y            <- round(1 + 2 * X1 + rnorm(300), 2)
df           <- as.data.frame(cbind(Y, X1, X2, state, year))
df$Y         <- as.numeric(as.character(df$Y))
df$X1        <- as.numeric(as.character(df$X1))
df$X2        <- as.numeric(as.character(df$X2))
df$year      <- as.numeric(as.character(df$year))
df$state.num <- rep(1:10, each = 30)
df$state     <- as.character(df$state)
df$`T`       <- ifelse(df$state == "A" & df$year >= 15, 1, 0)
df$Y         <- ifelse(df$state == "A" & df$year >= 15, df$Y + 20, df$Y)
library(Synth)
dataprep.out <-
dataprep(
df,
predictors = c("X1", "X2"),
dependent     = "Y",
unit.variable = "state.num",
time.variable = "year",
unit.names.variable = "state",
treatment.identifier  = 1,
controls.identifier   = c(2:10),
time.predictors.prior = c(1:14),
time.optimize.ssr     = c(1:14),
time.plot             = c(1:30)
)
library(Synth)
dataprep.out <-
dataprep(
df,
predictors = c("X1", "X2"),
dependent     = "Y",
unit.variable = "state.num",
time.variable = "year",
unit.names.variable = "state",
treatment.identifier  = 1,
controls.identifier   = c(2:10),
time.predictors.prior = c(1:14),
time.optimize.ssr     = c(1:14),
time.plot             = c(1:30)
)
synth.out <- synth(dataprep.out)
path.plot(synth.res    = synth.out,
dataprep.res = dataprep.out,
Ylab         = c("Y"),
Xlab         = c("Year"),
Legend       = c("State A","Synthetic State A"),
Legend.position = c("topleft")
)
abline(v   = 15,
lty = 2)
knitr::opts_chunk$set(echo = TRUE)
library(FrF2)
d<-FrF2(16, 5, randomize=FALSE)
d$y<-rnorm(16)
aliases( lm( y~ (.)^4, data = d))
d<-FrF2(16, 5, randomize=FALSE)
d<-as.data.frame(d)
d<-rbind(d, d)
d
set.seed(633)  # Setting seed for reproducibility
shuffled_experiments <- d[sample(nrow(d)), ]
shuffled_experiments
View(shuffled_experiments)
