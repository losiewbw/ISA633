results<-c()
d<-c(5, 10, 15, 30, 35, 40, 45, 50, 60, 65)
for(i in 1:length(d)){
results[i]<-power.t.test(delta=d[i], n=NULL, sd=30, sig.level=0.1, power=0.8)$n
}
plot(d, results, xlab="delta", ylab="sample size")
power.prop.test(n=NULL, p1=0.23, p2=0.28, sig.level = 0.05, power=.8)
power.prop.test(n=NULL, p1=0.023, p2=0.023+0.05*0.023, sig.level = 0.05, power=.8)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/zappos.csv")
df_long <- df %>% pivot_longer(everything(),
names_to"treatment",
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/zappos.csv")
df_long <- df %>% pivot_longer(everything(),
names_to = "treatment",
values_to = "spend")
df_long$treatment<- as.factor(df_long$treatment)
df_long %>% group_by(treatment) %>% summarize("mean sales" = mean(spend),
"std sales" = sd(spend), "count" = n())
boxplot(df_long$spend~df_long$treatment)
mod<-aov(spend~treatment, data = df_long)
summary(mod)
library(multcomp)
install.packages("multcomp")
library(multcomp)
tukey<-glht(mod, linfct=mcp(treatments="Tukey"))
library(multcomp)
tukey<-glht(mod, linfct=mcp(treatment="Tukey"))
cld(tukey)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/zappos.csv")
df_long <- df %>% pivot_longer(everything(),
names_to = "treatment",
values_to = "spend")
df_long$treatment<- as.factor(df_long$treatment)
df_long %>% group_by(treatment) %>% summarize("mean sales" = mean(spend),
"std sales" = sd(spend), "count" = n())
boxplot(df_long$spend~df_long$treatment)
mod<-aov(spend~treatment, data = df_long)
summary(mod)
library(multcomp)
tukey<-glht(mod, linfct=mcp(treatment="Tukey"))
cld(tukey)
summary(tukey)
plot(tukey)
t.test(df$C)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/uber.csv")
df_long <- df %>% pivot_longer(everything(),
names_to = "treatment",
values_to = "bookings")
df_long$treatment<- as.factor(df_long$treatment)
df_long %>% group_by(treatment, bookings) %>% summarize(n=n()) %>% mutate(freq=n/sum(n))
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/uber.csv")
df_long <- df %>% pivot_longer(everything(),
names_to = "treatment",
values_to = "bookings")
df_long$treatment<- as.factor(df_long$treatment)
df_long %>% group_by(treatment, bookings) %>% summarize(n=n()) %>% mutate(freq=n/sum(n))
full<-glm(bookings~treatment, data=df_long, family="binomial")
anova(full, test="Chisq")
library(multcomp)
comps<-glht(full, linfct = mcp(treatment="Tukey"))
summary(comps)
plot(comps)
0.05/55
1-(1-0.05)^30
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
library(tidyverse)
df %>% group_by(script) %>% summarize("mean"=mean(seconds), "sd"=sd(seconds), "count"=n())
df %>% ggplot(aes(x=agent, y=seconds, group=script))+geom_text(aes(label=script), size=6)+
xlab("Agent")+ylab("Seconds")+
theme_bw()+
theme(axis.title=element_text(size=18))
mod1<-aov(seconds~script+agent, data=df)
summary(mod1)
mod1<-aov(seconds~script+agent, data=df)
summary(mod1)
original_par <- par() #saves the default graphics settings so when we change them to make residual plots or the Tukey plots we can revert.
library(multcomp)
tukey<-glht(mod1, linfct=mcp(script="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod1) ~ as.factor(script), main="Residuals vs Exp. Unit", font.main=1,data=df)
abline(h = 0, lty = 2)
set.seed(13)
script<-factor(c(1,2,3,4))
agent1t <- sample(script,4)
agent2t <- sample(script,4)
agent3t <- sample(script,4)
agent4t <- sample(script,4)
agent5t <- sample(script,4)
agent6t <- sample(script,4)
treatments<-c(agent1t,agent2t, agent3t, agent4t, agent5t, agent6t)
block <- factor( rep(c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6"),each=4))
plan<-data.frame("Agent" = block, "treatment", "Script" = treatments)
plan
library(agricolae)
script<-c(1,2,3,4)
outdesign <- design.rcbd(script, r=6, seed = 13)
rcb <- outdesign$book
levels(rcb$block) <- c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6")
rcb
set.seed(13)
rcb$y<-round(rnorm(24), digits = 1)
rcb
library(agricolae)
script<-c(1,2,3,4)
outdesign <- design.rcbd(script, r=6, seed = 13)
rcb <- outdesign$book
levels(rcb$block) <- c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6")
rcb
set.seed(13)
rcb$y<-round(rnorm(24), digits = 1)
rcb
mod<-aov(y~block+script, data=rcb)
summary(mod)
library(agricolae)
display<-c(1,2,3,4)
outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd
lsd$sales<-75+3*as.numeric(outdesign$book$row)+4*as.numeric(outdesign$book$col)+10*as.numeric(outdesign$book$display)+rnorm(16,0,3)
lsd$sales<-round(lsd$sales, 2)
lsd
lsd %>% ggplot(aes(x=row, y=sales, group=display))+
geom_text(aes(label=display))+
facet_grid(~col)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),axis.title.x = element_blank())+
ylab("Total Sales")
mod<-aov(sales~row+col+display, data=lsd)
summary(mod)
par(original_par) #removes the formatting for the residual plots above
library(multcomp)
tukey<-glht(mod, linfct=mcp(display="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod) ~ display, main="Residuals vs Exp. Unit", font.main=1,data=lsd)
abline(h = 0, lty = 2)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CarData.csv")
df
mod<-aov(distance1~speed+fuel+car, data=df)
summary(mod)
df_long<-df %>% pivot_longer(c("distance1", "distance2"),
names_to="replicate",
values_to="distance")
df_long
mod<-aov(distance~speed+fuel+car, data=df_long)
summary(mod)
mod<-aov(distance~speed+fuel+car+replicate, data=df_long)
summary(mod)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/humana_rate.csv")
library(knitr)
library(kableExtra)
knitr::kable(head(df)) %>%
kable_styling(full_width=F)
library(tidyverse)
df_long<- df %>% pivot_longer(everything(),
names_to="treatment",
values_to="clicks")
library(knitr)
library(kableExtra)
knitr::kable(head(df_long)) %>%
kable_styling(full_width=F)
df_long %>% group_by(treatment, clicks) %>% summarise(n=n()) %>% mutate(freq=n/sum(n))
df_long$clicks<-as.factor(df_long$clicks)
levels(df_long$clicks)
df_long$treatment<-as.factor(df_long$treatment)
levels(df_long$treatment)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/humana_rate.csv")
library(knitr)
library(kableExtra)
knitr::kable(head(df)) %>%
kable_styling(full_width=F)
library(tidyverse)
df_long<- df %>% pivot_longer(everything(),
names_to="treatment",
values_to="clicks")
library(knitr)
library(kableExtra)
knitr::kable(head(df_long)) %>%
kable_styling(full_width=F)
df_long %>% group_by(treatment, clicks) %>% summarise(n=n()) %>% mutate(freq=n/sum(n))
df_long$clicks<-as.factor(df_long$clicks)
levels(df_long$clicks)
df_long$treatment<-as.factor(df_long$treatment)
levels(df_long$treatment)
df_long$treatment<-relevel(df_long$treatment, "control", "A", "B")
levels(df_long$treatment)
mod<-glm(clicks~treatment, data=df_long, family="binomial")
summary(mod)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
library(tidyverse)
df %>% group_by(script) %>% summarize("mean"=mean(seconds), "sd"=sd(seconds), "count"=n())
df %>% ggplot(aes(x=agent, y=seconds, group=script))+geom_text(aes(label=script), size=6)+
xlab("Agent")+ylab("Seconds")+
theme_bw()+
theme(axis.title=element_text(size=18))
mod1<-aov(seconds~script+agent, data=df)
summary(mod1)
original_par <- par() #saves the default graphics settings so when we change them to make residual plots or the Tukey plots we can revert.
library(multcomp)
tukey<-glht(mod1, linfct=mcp(script="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod1) ~ as.factor(script), main="Residuals vs Exp. Unit", font.main=1,data=df)
abline(h = 0, lty = 2)
set.seed(13)
script<-factor(c(1,2,3,4))
agent1t <- sample(script,4)
agent2t <- sample(script,4)
agent3t <- sample(script,4)
agent4t <- sample(script,4)
agent5t <- sample(script,4)
agent6t <- sample(script,4)
treatments<-c(agent1t,agent2t, agent3t, agent4t, agent5t, agent6t)
block <- factor( rep(c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6"),each=4))
plan<-data.frame("Agent" = block, "treatment", "Script" = treatments)
plan
library(agricolae)
script<-c(1,2,3,4)
outdesign <- design.rcbd(script, r=6, seed = 13)
rcb <- outdesign$book
levels(rcb$block) <- c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6")
rcb
set.seed(13)
rcb$y<-round(rnorm(24), digits = 1)
rcb
mod<-aov(y~block+script, data=rcb)
summary(mod)
library(agricolae)
display<-c(1,2,3,4)
outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd
lsd$sales<-75+3*as.numeric(outdesign$book$row)+4*as.numeric(outdesign$book$col)+10*as.numeric(outdesign$book$display)+rnorm(16,0,3)
lsd$sales<-round(lsd$sales, 2)
lsd
lsd %>% ggplot(aes(x=row, y=sales, group=display))+
geom_text(aes(label=display))+
facet_grid(~col)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),axis.title.x = element_blank())+
ylab("Total Sales")
mod<-aov(sales~row+col+display, data=lsd)
summary(mod)
par(original_par) #removes the formatting for the residual plots above
library(multcomp)
tukey<-glht(mod, linfct=mcp(display="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod) ~ display, main="Residuals vs Exp. Unit", font.main=1,data=lsd)
abline(h = 0, lty = 2)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CarData.csv")
df
mod<-aov(distance1~speed+fuel+car, data=df)
summary(mod)
df_long<-df %>% pivot_longer(c("distance1", "distance2"),
names_to="replicate",
values_to="distance")
df_long
mod<-aov(distance~speed+fuel+car, data=df_long)
summary(mod)
mod<-aov(distance~speed+fuel+car+replicate, data=df_long)
summary(mod)
df<-read.csv("I:\\Classes\\ISA 633\\4. Blocking\\blocking continuous\\golf.csv")
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/golf.csv")
head(df)
df$Tee.Hgt<-as.factor(df$Tee.Hgt)
df$Golfer.ID<-as.factor(df$Golfer.ID)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/golf.csv")
head(df)
df$Tee.Hgt<-as.factor(df$Tee.Hgt)
df$Golfer.ID<-as.factor(df$Golfer.ID)
View(df)
summary<-df %>% group_by(Golfer.ID, Tee.Hgt) %>% summarize("mean Distance"=mean(Distance), "Sd Distance"=sd(Distance), "n"=n())
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
library(tidyverse)
df %>% group_by(script) %>% summarize("mean"=mean(seconds), "sd"=sd(seconds), "count"=n())
df %>% ggplot(aes(x=agent, y=seconds, group=script))+geom_text(aes(label=script), size=6)+
xlab("Agent")+ylab("Seconds")+
theme_bw()+
theme(axis.title=element_text(size=18))
mod1<-aov(seconds~script+agent, data=df)
summary(mod1)
original_par <- par() #saves the default graphics settings so when we change them to make residual plots or the Tukey plots we can revert.
library(multcomp)
tukey<-glht(mod1, linfct=mcp(script="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod1) ~ as.factor(script), main="Residuals vs Exp. Unit", font.main=1,data=df)
abline(h = 0, lty = 2)
set.seed(13)
script<-factor(c(1,2,3,4))
agent1t <- sample(script,4)
agent2t <- sample(script,4)
agent3t <- sample(script,4)
agent4t <- sample(script,4)
agent5t <- sample(script,4)
agent6t <- sample(script,4)
treatments<-c(agent1t,agent2t, agent3t, agent4t, agent5t, agent6t)
block <- factor( rep(c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6"),each=4))
plan<-data.frame("Agent" = block, "treatment", "Script" = treatments)
plan
library(agricolae)
script<-c(1,2,3,4)
outdesign <- design.rcbd(script, r=6, seed = 13)
rcb <- outdesign$book
levels(rcb$block) <- c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6")
rcb
set.seed(13)
rcb$y<-round(rnorm(24), digits = 1)
rcb
mod<-aov(y~block+script, data=rcb)
summary(mod)
library(agricolae)
display<-c(1,2,3,4)
outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd
lsd$sales<-75+3*as.numeric(outdesign$book$row)+4*as.numeric(outdesign$book$col)+10*as.numeric(outdesign$book$display)+rnorm(16,0,3)
lsd$sales<-round(lsd$sales, 2)
lsd
lsd %>% ggplot(aes(x=row, y=sales, group=display))+
geom_text(aes(label=display))+
facet_grid(~col)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),axis.title.x = element_blank())+
ylab("Total Sales")
mod<-aov(sales~row+col+display, data=lsd)
summary(mod)
par(original_par) #removes the formatting for the residual plots above
library(multcomp)
tukey<-glht(mod, linfct=mcp(display="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod) ~ display, main="Residuals vs Exp. Unit", font.main=1,data=lsd)
abline(h = 0, lty = 2)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CarData.csv")
df
mod<-aov(distance1~speed+fuel+car, data=df)
summary(mod)
df_long<-df %>% pivot_longer(c("distance1", "distance2"),
names_to="replicate",
values_to="distance")
df_long
mod<-aov(distance~speed+fuel+car, data=df_long)
summary(mod)
mod<-aov(distance~speed+fuel+car+replicate, data=df_long)
summary(mod)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/golf.csv")
head(df)
df$Tee.Hgt<-as.factor(df$Tee.Hgt)
df$Golfer.ID<-as.factor(df$Golfer.ID)
summary<-df %>% group_by(Golfer.ID, Tee.Hgt) %>% summarize("mean Distance"=mean(Distance), "Sd Distance"=sd(Distance), "n"=n())
summary<-df %>% group_by(Golfer.ID, Tee.Hgt) %>% summarize("mean Distance"=mean(Distance), "Sd Distance"=sd(Distance), "n"=n())
library(kableExtra)
knitr::kable(
summary,
caption="Summary"
)%>% kable_styling(bootstrap_options = c("striped", "hover"),
full_width = F,
font_size = 12,
position = "left")
df %>% ggplot(aes(x=Golfer.ID, y=Distance, group=interaction(Tee.Hgt, Golfer.ID)))+
geom_boxplot(aes(color=Tee.Hgt))+
theme_bw()+
xlab("Golfer")+
guides(color = guide_legend(title = "Tee Height"))
mod <- aov(Distance ~ Tee.Hgt + Error(Golfer.ID/Tee.Hgt), data = df)
summary(mod)
mod<-aov(Distance~Tee.Hgt*Golfer.ID, data=df)
summary(mod)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/typing.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("before", "after"),
names_to = "test",
values_to="score")
library(tidyverse)
df_long<-df %>% pivot_longer(c("before", "after"),
names_to = "test",
values_to="score")
boxplot(score~test,data=df_long)
View(df)
df_long %>% group_by(test) %>% summarize("mean"=mean(score), "sd"=sd(score), "count"=n())
t.test(score~test, data=df_long)
df_long$test<-factor(df_long$test, levels=c("before", "after"))
df_long %>% ggplot(aes(x=test, y=score, group=employee))+
geom_line(alpha=0.8)+
geom_point(alpha=0.7, size=2.5)+
theme_bw(base_size = 12)+
xlab("")+
ylab("Test score")
t.test(score~test, data=df_long, paired=TRUE)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
power.t.test(delta=15, sd=30, sig.level=0.05, n=NULL, power=0.80)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
View(df)
library(multcomp)
tukey<-glht(mod1, linfct=mcp(script="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
mower<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowersex.csv", stringsAsFactors = TRUE)
mower$Y.ownership<-as.factor(mower$Y.ownership)
prop.table(table(mower$Ownership))
levels(mower$Ownership)
log.reg<-glm(Ownership~., data=mower[,-4], family="binomial")
summary(log.reg)
exp( 0.9638 )
summary(log.reg)
1-pchisq(33.271-15.323, 23-21)
mower1<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/RidingMowers2.csv", stringsAsFactors = TRUE)
mower1$Baldness<-as.factor(mower1$Baldness)
log.reg1<-glm(Ownership~., data=mower1, family="binomial")
summary(log.reg1)
exp( 3.12185)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
power.t.test(delta=5, sd=11, power=0.8, sig.level = 0.05, type="paired")
