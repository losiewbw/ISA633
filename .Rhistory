for (i in 1:length(size)){
control.index<-sample(1:nrow(df), size=size[i])
s<-df[control.index, ]
control.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
control.loan[i]=0
} else {
control.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
control.housing[i]=0
} else {
control.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
treat.index<-sample(1:nrow(df[-control.index,]), size=size[i])
dfc<-df[-control.index,]
s<-dfc[treat.index, ]
treat.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
treat.loan[i]=0
} else {
treat.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
treat.housing[i]=0
} else {
treat.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
}
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/BankData.csv")
df %>% summarize("amount mean"=mean(amount), "amount sd"=sd(amount))
df %>% count(loan) %>% mutate(prop=prop.table(n))
df %>% count(housing) %>% mutate(prop=prop.table(n))
size<-c(10, 30, 100, 250, 500, 1000, 2000, 4000, 8000)
control.amount<-c()
control.loan<-c()
control.housing<-c()
treat.amount<-c()
treat.loan<-c()
treat.housing<-c()
for (i in 1:length(size)){
control.index<-sample(1:nrow(df), size=size[i])
s<-df[control.index, ]
control.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
control.loan[i]=0
} else {
control.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
control.housing[i]=0
} else {
control.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
treat.index<-sample(1:nrow(df[-control.index,]), size=size[i])
dfc<-df[-control.index,]
s<-dfc[treat.index, ]
treat.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
treat.loan[i]=0
} else {
treat.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
treat.housing[i]=0
} else {
treat.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
}
control<-data.frame(size, amount=control.amount, loan=control.loan, housing=control.housing)
control
treatment<-data.frame(size, amount=treat.amount, loan=treat.loan, housing=treat.housing)
treatment
res<-rbind(control, treatment)
res$type<-c(rep("control",nrow(control)), rep("treamtment", nrow(treatment)))
ggplot(res, aes(x=size, y=amount, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=mean(df$amount),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("average amount in account")+
theme(legend.title=element_blank())
ggplot(res, aes(x=size, y=loan, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=(table(df$loan)[2]/sum(table(df$loan))),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("proportion of personal loan=yes")+
theme(legend.title=element_blank())
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
d<-expand.grid(Background=c("A", "B", "C"), Font=c(10, 12, 14), Color=c(1, 2), Signup=c("button", "link"))
d
library(daewr)
web<-web
web
mod<-glm( cbind(signup, visitors-signup) ~ A * B * C * D, data = web, family = binomial )
anova(mod, test="Chisq")
mod<-glm( cbind(signup, visitors-signup) ~ A * B * C * D-A:B:C:D-B:C:D-A:B:D-A:B:C-B:D-B:C-A:B, data = web, family = binomial )
anova(mod, test="Chisq")
web$A<-as.numeric(web$A)
web$B<-as.numeric(web$B)
web$C<-as.numeric(web$C)
web$D<-as.numeric(web$D)
mod<-glm( cbind(signup, visitors-signup) ~ A * B * C * D-A:B:C:D-B:C:D-A:B:D-A:B:C-B:D-B:C-A:B, data = web, family = binomial )
library(sjPlot)
plot_model(mod, type="int", axis.title = ("Proportion of Signups"), title="Predicted Probablities of visitor sign-ups")[[4]]
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/walmart.csv")
head(df)
View(d)
View(df)
par( mfrow = c(1,2))
boxplot(time~stations, data=df)
boxplot(time~hosts, data=df)
df$stations<-as.factor(df$stations)
df$hosts<-as.factor(df$hosts)
df$test.store<-as.factor(df$test.store)
mod<-aov(time~test.store+hosts+stations+hosts*stations, data=df)
summary(mod)
library(sjPlot)
plot_model(mod, type="int")
par( mfrow = c(1,1))
with(df, (interaction.plot(hosts, stations, time, type = "b",
pch = c(18,24,22), leg.bty = "o",
main = "Interaction plot Stations and Hosts",
xlab = "Hosts",ylab = "Stations")))
par( mfrow = c(1,1))
with(df, (interaction.plot(hosts, stations, time, type = "b",
pch = c(18,24,22), leg.bty = "o",
main = "Interaction plot Stations and Hosts",
xlab = "Hosts",ylab = "Time")))
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
3*3*2*3*2
2*2*2*2*2
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/miami.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("Friend", "Togo", "PerctOff"),
names_to = "mailer",
values_to="spend")
df_long$mailer<-as.factor(df_long$mailer)
boxplot(spend~mailer,data=df_long)
df_nonzero <- filter(df_long, spend > 0)
boxplot(spend~mailer,data=df_nonzero)
df_nonzero %>% group_by(mailer) %>% summarize("mean"=mean(spend), "sd"=sd(spend), "count"=n())
df_nonzero %>% group_by(mailer) %>% summarize("mean"=mean(spend), "sd"=sd(spend), "count"=n())
original_par <- par()
library(multcomp)
tukey<-glht(mod1, linfct=mcp(mailer="Tukey"))
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/miami.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("Friend", "Togo", "PerctOff"),
names_to = "mailer",
values_to="spend")
df_long$mailer<-as.factor(df_long$mailer)
boxplot(spend~mailer,data=df_long)
df_nonzero <- filter(df_long, spend > 0)
boxplot(spend~mailer,data=df_nonzero)
df_nonzero %>% group_by(mailer) %>% summarize("mean"=mean(spend), "sd"=sd(spend), "count"=n())
mod1<-aov(spend~mailer+Year, data=df_nonzero)
summary(mod1)
original_par <- par()
library(multcomp)
tukey<-glht(mod1, linfct=mcp(mailer="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
set.seed(13)
configuration <- factor(c(1,2,3,4,5))
store1 <- sample(configuration,5)
store2 <- sample(configuration,5)
store3 <- sample(configuration,5)
store4 <- sample(configuration,5)
store5 <- sample(configuration,5)
treatments<-c(store1, store2, store3, store4, store5)
block <- factor( rep(c("store 1", "store 2", "store 3", "store 4", "store 5"),each=5))
plan<-data.frame("Store" = block, "treatment", "Configuration" = treatments)
plan
library(agricolae)
store<-c(1,2,3,4,5)
outdesign<-design.lsd(store, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Month 1", "Month 2", "Month 3", "Month 4", "Month 5")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4", "Store 5")
lsd
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/miami.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("Friend", "Togo", "PerctOff"),
names_to = "mailer",
values_to="spend")
df_long$mailer<-as.factor(df_long$mailer)
boxplot(spend~mailer,data=df_long)
df_nonzero <- filter(df_long, spend > 0)
boxplot(spend~mailer,data=df_nonzero)
df_nonzero %>% group_by(mailer) %>% summarize("mean"=mean(spend), "sd"=sd(spend), "count"=n())
mod1<-aov(spend~mailer+Year, data=df_nonzero)
summary(mod1)
original_par <- par()
library(multcomp)
tukey<-glht(mod1, linfct=mcp(mailer="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
library(agricolae)
store<-c(1,2,3,4,5)
outdesign<-design.lsd(store, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Month 1", "Month 2", "Month 3", "Month 4", "Month 5")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4", "Store 5")
lsd
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/beer.csv")
df_long<-df %>% pivot_longer(c("beer1", "beer2"),
names_to = "beer",
values_to="rating")
df_long$X <- NULL
boxplot(rating~beer,data=df_long)
df_long %>% group_by(beer) %>% summarize("mean"=mean(rating), "sd"=sd(rating), "count"=n())
t.test(rating~beer, data=df_long, paired=TRUE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/mayo.csv")
head(df)
df$mayo<-as.factor(df$mayo)
df$person<-as.factor(df$person)
summary<-df %>% group_by(person, mayo) %>% summarize("mean Score"=mean(score), "Sd Score"=sd(score), "n"=n())
library(kableExtra)
knitr::kable(
summary,
caption="Summary"
)%>% kable_styling(bootstrap_options = c("striped", "hover"),
full_width = F,
font_size = 12,
position = "left")
df %>% ggplot(aes(x=person, y=score, group=interaction(mayo, person)))+
geom_boxplot(aes(color=mayo))+
theme_bw()+
xlab("Person")+
guides(color = guide_legend(title = "Mayo"))
mod <- aov(score ~ mayo + Error(person/mayo), data = df)
summary(mod)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/HarrysDemographicData.csv", stringsAsFactors = TRUE)
library(DataExplorer)
plot_missing(df)
View(df)
model <- lm(harrys_sales_last_month ~ ., data = df)
df$predicted_sales <- predict(model)
df <- df[order(df$predicted_sales, decreasing = TRUE), ]
head(df)
df <- df[-(1:3), ]
head(df)
df$predicted_sales_diff <- c(NA, diff(df$predicted_sales))
df <- df[order(df$predicted_sales_diff, decreasing = TRUE),]
pairs <- matrix(df$sma[1:16], ncol = 2, byrow = TRUE)
pairs
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CallCenter.csv", stringsAsFactors = TRUE)
df$agent<-as.factor(df$agent)
library(tidyverse)
df %>% group_by(script) %>% summarize("mean"=mean(seconds), "sd"=sd(seconds), "count"=n())
df %>% ggplot(aes(x=agent, y=seconds, group=script))+geom_text(aes(label=script), size=6)+
xlab("Agent")+ylab("Seconds")+
theme_bw()+
theme(axis.title=element_text(size=18))
mod1<-aov(seconds~script+agent, data=df)
summary(mod1)
original_par <- par() #saves the default graphics settings so when we change them to make residual plots or the Tukey plots we can revert.
library(multcomp)
tukey<-glht(mod1, linfct=mcp(script="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod1) ~ as.factor(script), main="Residuals vs Exp. Unit", font.main=1,data=df)
abline(h = 0, lty = 2)
set.seed(13)
script<-factor(c(1,2,3,4))
agent1t <- sample(script,4)
agent2t <- sample(script,4)
agent3t <- sample(script,4)
agent4t <- sample(script,4)
agent5t <- sample(script,4)
agent6t <- sample(script,4)
treatments<-c(agent1t,agent2t, agent3t, agent4t, agent5t, agent6t)
block <- factor( rep(c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6"),each=4))
plan<-data.frame("Agent" = block, "treatment", "Script" = treatments)
plan
library(agricolae)
script<-c(1,2,3,4)
outdesign <- design.rcbd(script, r=6, seed = 13)
rcb <- outdesign$book
levels(rcb$block) <- c("agent 1", "agent 2", "agent 3", "agent 4", "agent 5", "agent 6")
rcb
set.seed(13)
rcb$y<-round(rnorm(24), digits = 1)
rcb
library(agricolae)
display<-c(1,2,3,4)
outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd
lsd$sales<-75+3*as.numeric(outdesign$book$row)+4*as.numeric(outdesign$book$col)+10*as.numeric(outdesign$book$display)+rnorm(16,0,3)
lsd$sales<-round(lsd$sales, 2)
lsd
lsd %>% ggplot(aes(x=row, y=sales, group=display))+
geom_text(aes(label=display))+
facet_grid(~col)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),axis.title.x = element_blank())+
ylab("Total Sales")
mod<-aov(sales~row+col+display, data=lsd)
summary(mod)
par(original_par) #removes the formatting for the residual plots above
mod<-aov(sales~row+col+display, data=lsd)
summary(mod)
par(original_par) #removes the formatting for the residual plots above
library(multcomp)
tukey<-glht(mod, linfct=mcp(display="Tukey"))
summary(tukey)
par(mar = c(5, 8, 4, 2))
plot(tukey)
par( mfrow = c(2,2) )
plot(mod1, which=5)
plot(mod1, which=1)
plot(mod1, which=2)
plot(residuals(mod) ~ display, main="Residuals vs Exp. Unit", font.main=1,data=lsd)
abline(h = 0, lty = 2)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/CarData.csv")
df
df_long<-df %>% pivot_longer(c("distance1", "distance2"),
names_to="replicate",
values_to="distance")
df_long
mod<-aov(distance~speed+fuel+car, data=df_long)
summary(mod)
mod<-aov(distance~speed+fuel+car+replicate, data=df_long)
summary(mod)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/golf.csv")
head(df)
df$Tee.Hgt<-as.factor(df$Tee.Hgt)
df$Golfer.ID<-as.factor(df$Golfer.ID)
summary<-df %>% group_by(Golfer.ID, Tee.Hgt) %>% summarize("mean Distance"=mean(Distance), "Sd Distance"=sd(Distance), "n"=n())
library(kableExtra)
knitr::kable(
summary,
caption="Summary"
)%>% kable_styling(bootstrap_options = c("striped", "hover"),
full_width = F,
font_size = 12,
position = "left")
df %>% ggplot(aes(x=Golfer.ID, y=Distance, group=interaction(Tee.Hgt, Golfer.ID)))+
geom_boxplot(aes(color=Tee.Hgt))+
theme_bw()+
xlab("Golfer")+
guides(color = guide_legend(title = "Tee Height"))
mod <- aov(Distance ~ Tee.Hgt + Error(Golfer.ID/Tee.Hgt), data = df)
summary(mod)
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/enterprise.csv")
df_long <- df %>% pivot_longer(!Block,
names_to='factor',
values_to = "CTR"
)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/enterprise.csv")
df_long <- df %>% pivot_longer(!Block,
names_to='factor',
values_to = "CTR"
)
df_long %>% group_by(factor, CTR) %>% summarise(n=n()) %>% mutate(freq=n/sum(n))
df_long %>% group_by(Block, CTR) %>% summarise(n=n()) %>% mutate(freq=n/sum(n))
df_long$factor<-as.factor(df_long$factor)
df_long$Block<-as.factor(df_long$Block)
mod<-glm(CTR~factor+Block, data=df_long, family="binomial")
anova(mod, test="Chisq")
library(multcomp)
comps<-glht(mod, linfct = mcp(factor="Tukey"))
summary(comps)
plot(comps)
summary(mod)
exp(-0.53479)
prop.test(x=868, n=19132+868)
a=868+1
b=19132+1
qbeta(0.025, a,b)
qbeta(0.975,a,b)
set.seed(13)
library(agricolae)
display<-c(1,2,3,4)
outdesign<-design.lsd(display, seed=13)
lsd<-outdesign$book
levels(lsd$row)<-c("Week 1", "Week 2", "Week 3", "Week 4")
levels(lsd$col)<-c("Store 1", "Store 2", "Store 3", "Store 4")
lsd$y<-round(runif(16, min=1, max=84))
lsd
lsd$reps<-rep(12*7, 16)
lsd
mod<-glm(cbind(y, reps-y)~row+col+display, data=lsd, family="binomial")
anova(mod, test="Chisq")
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/BankData.csv")
df %>% summarize("amount mean"=mean(amount), "amount sd"=sd(amount))
df %>% count(loan) %>% mutate(prop=prop.table(n))
df %>% count(housing) %>% mutate(prop=prop.table(n))
size<-c(10, 30, 100, 250, 500, 1000, 2000, 4000, 8000)
control.amount<-c()
control.loan<-c()
control.housing<-c()
treat.amount<-c()
treat.loan<-c()
treat.housing<-c()
for (i in 1:length(size)){
control.index<-sample(1:nrow(df), size=size[i])
s<-df[control.index, ]
control.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
control.loan[i]=0
} else {
control.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
control.housing[i]=0
} else {
control.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
treat.index<-sample(1:nrow(df[-control.index,]), size=size[i])
dfc<-df[-control.index,]
s<-dfc[treat.index, ]
treat.amount[i]<-mean(s$amount)
if(table(s$loan)[2]==0){
treat.loan[i]=0
} else {
treat.loan[i]<-table(s$loan)[2]/sum(table(s$loan))
}
if(s$housing[2]==0){
treat.housing[i]=0
} else {
treat.housing[i]<-table(s$housing)[2]/sum(table(s$housing))
}
}
control<-data.frame(size, amount=control.amount, loan=control.loan, housing=control.housing)
control
treatment<-data.frame(size, amount=treat.amount, loan=treat.loan, housing=treat.housing)
treatment
res<-rbind(control, treatment)
res$type<-c(rep("control",nrow(control)), rep("treamtment", nrow(treatment)))
ggplot(res, aes(x=size, y=amount, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=mean(df$amount),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("average amount in account")+
theme(legend.title=element_blank())
ggplot(res, aes(x=size, y=loan, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=(table(df$loan)[2]/sum(table(df$loan))),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("proportion of personal loan=yes")+
theme(legend.title=element_blank())
ggplot(res, aes(x=size, y=housing, group=type, color=type))+
geom_line(size=1)+
geom_hline(yintercept=(table(df$housing)[2]/sum(table(df$housing))),linetype="dashed")+
theme_bw()+xlab("sample size")+ylab("proportion of personal loan=yes")+
theme(legend.title=element_blank())
knitr::opts_chunk$set(echo = TRUE,
cache = TRUE,
warning = FALSE,
message = FALSE)
df<-read.csv("https://raw.githubusercontent.com/losiewbw/ISA633/main/typing.csv")
library(tidyverse)
df_long<-df %>% pivot_longer(c("before", "after"),
names_to = "test",
values_to="score")
boxplot(score~test,data=df_long)
df_long %>% group_by(test) %>% summarize("mean"=mean(score), "sd"=sd(score), "count"=n())
t.test(score~test, data=df_long)
df_long$test<-factor(df_long$test, levels=c("before", "after"))
df_long %>% ggplot(aes(x=test, y=score, group=employee))+
geom_line(alpha=0.8)+
geom_point(alpha=0.7, size=2.5)+
theme_bw(base_size = 12)+
xlab("")+
ylab("Test score")
t.test(score~test, data=df_long, paired=TRUE)
power.t.test(delta=5, sd=11, power=0.8, sig.level = 0.05, type="paired")
